# 小学成绩分析系统 - 使用说明

## 快速开始

### 第一步：安装和启动

1. 打开命令行工具（Windows: PowerShell 或 CMD）
2. 进入项目目录：
```bash
cd D:\新建文件夹\sanlv
```

3. 安装依赖（首次使用需要）：
```bash
npm install
```

4. 启动系统：
```bash
npm run dev
```

5. 浏览器会自动打开 http://localhost:3000

### 第二步：准备Excel文件

Excel文件格式要求：

**必须包含的列：**
- 姓名列（学生姓名）

**学科成绩列：**
- 可以是任意学科名称，如：语文、数学、英语、科学、音乐、体育等
- 系统会自动识别

**示例格式：**

| 姓名 | 语文 | 数学 | 英语 | 科学 |
|------|------|------|------|------|
| 张三 | 95   | 88   | 92   | 90   |
| 李四 | 87   | 92   | 85   | 88   |
| 王五 | 90   | 85   | 88   | 92   |

### 第三步：上传成绩

1. 点击左侧菜单 **"成绩上传"**
2. 输入年级（如：1）和班级（如：1）
3. 拖拽或点击上传Excel文件
4. 系统会自动识别学科
5. 设置每个学科的总分（默认100分）
6. 预览数据无误后，点击 **"保存数据"**

### 第四步：查看分析

#### 年级数据分析
- 点击 **"年级数据"** 菜单
- 选择要查看的年级
- 可以查看：
  - 年级总分三率标准分
  - 年级各学科三率标准分
  - 全年级学生排名（含班级排名和年级排名）

#### 班级数据分析
- 点击 **"班级数据"** 菜单
- 选择年级和班级
- 可以查看：
  - 班级总分三率（优秀率、及格率、综合率）
  - 班级各学科三率
  - 班级学生成绩表

#### 历史成绩对比
- 点击 **"历史对比"** 菜单
- 选择年级、班级和学生
- 可以查看：
  - 总分趋势图
  - 各学科成绩趋势图
  - 历史成绩明细表

### 第五步：数据管理

#### 查看数据
- 点击 **"数据管理"** 菜单
- 查看所有已上传的记录
- 查看数据统计

#### 清除数据（学期结束时使用）
- 在数据管理页面
- 点击 **"清除所有数据"** 按钮
- 确认后会删除所有数据
- ⚠️ 此操作不可恢复，请谨慎使用！

## 注意事项

### ⚠️ 数据安全
- 所有数据保存在浏览器本地（LocalStorage）
- 清除浏览器数据会导致成绩丢失
- 更换浏览器或电脑需要重新上传
- **建议保留原始Excel文件作为备份**

### ✅ 使用建议
- 每次考试后及时上传成绩
- 定期查看历史对比了解学生进步
- 学期结束前导出重要数据
- 新学期开始时清除旧数据

### 📊 数据计算说明

#### 参评人数
- 总人数的90%

#### 优秀率标准分
- 总分：将年级所有学生总分成绩按照从高到低的顺序排列，参评人数取总人数的90%，取参评人数的第前20%名学生分数作为优秀率计数标准分
- 学科：将年级所有学生的各个学科成绩按照从高到低的顺序排列，参评人数取总人数的90%，分别取各个学科参评人数的第前20%名学生分数作为优秀率计数标准分

#### 及格率标准分
- 总分：所有学科总分的60%
- 学科：该学科总分的60%

#### 综合率标准分
- 总分：参评学生的总分平均分
- 学科：参评学生该学科的平均分

#### 班级三率计算
- 优秀率 = 达到优秀标准的学生数 / 参评人数 × 100%
- 及格率 = 达到及格标准的学生数 / 参评人数 × 100%
- 综合率 = 达到综合标准的学生数 / 参评人数 × 100%
- 三率之和 = 优秀率 + 及格率 + 综合率

## 常见问题

### Q: Excel文件上传失败？
A: 请检查：
- 文件格式是否为 .xlsx 或 .xls
- 是否包含姓名列
- 是否已输入年级和班级

### Q: 数据显示不正常？
A: 请检查：
- Excel中的成绩是否为数字格式
- 是否有空白单元格
- 学科总分设置是否正确

### Q: 如何备份数据？
A: 保留原始Excel文件即可，系统数据存储在浏览器本地

### Q: 可以在手机上使用吗？
A: 建议在电脑上使用，手机端可能显示不佳

## 技术支持

如遇到问题，请检查：
1. Node.js 是否已安装（需要 14.0 以上版本）
2. 浏览器是否为最新版本
3. 是否按照步骤正确操作

## 系统要求

- **操作系统**：Windows / macOS / Linux
- **浏览器**：Chrome / Edge / Firefox / Safari（推荐使用Chrome）
- **Node.js**：14.0 或以上版本
- **屏幕分辨率**：建议 1366×768 或以上

祝使用愉快！ 📚

